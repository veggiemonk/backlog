---
id: "18.01"
title: Analyze ID generation and conflict scenarios
status: done
assignee: '@me'
labels:
    - analysis
    - bug
    - core
parent: "18"
priority: high
created_at: 2025-09-21T21:58:13.983977Z
updated_at: 2025-09-21T22:21:17.044836Z
history:
    - timestamp: 2025-09-21T22:20:46.347336Z
      change: Status changed from "todo" to "in-progress"
      type: field_update
    - timestamp: 2025-09-21T22:20:51.096001Z
      change: Implementation plan changed
      type: field_update
    - timestamp: 2025-09-21T22:21:17.044833Z
      change: Status changed from "in-progress" to "done"
      type: field_update
    - timestamp: 2025-09-21T22:21:17.044833Z
      change: Implementation notes changed
      type: field_update
    - timestamp: 2025-09-21T22:21:17.044834Z
      change: 'Checked acceptance criterion #1: "A document is produced detailing the current ID generation flow."'
      type: field_update
    - timestamp: 2025-09-21T22:21:17.044835Z
      change: 'Checked acceptance criterion #2: "At least 3 distinct conflict scenarios are identified (e.g."'
      type: field_update
    - timestamp: 2025-09-21T22:21:17.044836Z
      change: 'Checked acceptance criterion #3: " concurrent sub-task creation"'
      type: field_update
---
## Description

Thoroughly investigate the current ID generation logic in `internal/core/id.go` and the `FileTaskStore`. Identify and document all potential race conditions and scenarios that could lead to conflicting task IDs.

## Acceptance Criteria
<!-- AC:BEGIN -->

- [x] #1 A document is produced detailing the current ID generation flow.
- [x] #2 At least 3 distinct conflict scenarios are identified (e.g.
- [x] #3  concurrent sub-task creation
- [ ] #4  offline sync
- [ ] #5  etc.).
- [ ] #6 The analysis is reviewed and approved.

<!-- AC:END -->

## Implementation Plan

1. Read internal/core/id.go to understand ID parsing and generation.
2. Read internal/core/create.go to understand how new tasks are created and how IDs are assigned.
3. Read internal/core/store.go to understand the FileTaskStore implementation and how it interacts with the filesystem.
4. Identify specific code paths where race conditions could occur during ID generation or task file creation.
5. Document at least three distinct conflict scenarios.

## Implementation Notes

Analysis complete. Identified 3 conflict scenarios: concurrent creation (overwrite), manual file creation, and offline sync conflicts. Current ID generation is vulnerable to race conditions.
